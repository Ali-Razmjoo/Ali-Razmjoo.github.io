<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Gmail | ZeroDay Cyber Research]]></title>
  <link href="http://z3r0d4y.com/blog/categories/gmail/atom.xml" rel="self"/>
  <link href="http://z3r0d4y.com/"/>
  <updated>2015-05-09T13:15:05-04:00</updated>
  <id>http://z3r0d4y.com/</id>
  <author>
    <name><![CDATA[Ali Razmjoo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Google Bug: Gmail 2-Step Verification Detector]]></title>
    <link href="http://z3r0d4y.com/blog/2015/02/04/google-bug-gmail-2-step-verification-detector/"/>
    <updated>2015-02-04T18:00:00-05:00</updated>
    <id>http://z3r0d4y.com/blog/2015/02/04/google-bug-gmail-2-step-verification-detector</id>
    <content type="html"><![CDATA[<p>Hello world! [ Including People , Robots, Zombies<span class="description">Dariush &amp; Arash</span>, Alien dudes if they exist, and my friends ], By the way, I decided to write about a Gmail Bug. It&rsquo;s not a vulnerability of Gmail but it&rsquo;s some kind of bug let us know if we hack a Gmail, we can login it or not without alert the Gmail owner. I talking about 2-Step verification, Imagine to grab a Gmail password and not be sure to login or not , victim might be use Gmail SMS auth service and when you click login, Google send victim a SMS which include a code to continue login. I got some way to test Gmail account before we login and test it if account have notification or not without any alert SMS. Keep reading to know how to do it.</p>




<!-- more -->




<p>As we know , Google SMTP can be used to login Gmail from anywhere .so we login from there[SMTP] and check what Gmail SMTP return to us. So now I use a python code to login my account that I activated 2-step protection on that and if anyone login, it should send me a SMS.</p>




<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>gmail.py</span><a href='https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/gmail.py'>link</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python2.7</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">smtplib</span>
</span><span class='line'><span class="n">user</span> <span class="o">=</span> <span class="s">&#39;xxx@gmail.com&#39;</span>
</span><span class='line'><span class="n">passw</span> <span class="o">=</span> <span class="s">&#39;xxx&#39;</span>
</span><span class='line'><span class="n">smtp_host</span> <span class="o">=</span> <span class="s">&#39;smtp.gmail.com&#39;</span>
</span><span class='line'><span class="n">smtp_port</span> <span class="o">=</span> <span class="mi">587</span>
</span><span class='line'><span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">()</span>
</span><span class='line'><span class="n">server</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">smtp_host</span><span class="p">,</span><span class="n">smtp_port</span><span class="p">)</span>
</span><span class='line'><span class="n">server</span><span class="o">.</span><span class="n">ehlo</span><span class="p">()</span>
</span><span class='line'><span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
</span><span class='line'><span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passw</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>




<p>And when run the script my result was:</p>




<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Users\Ali\Desktop\gmail.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">22</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passw</span><span class="p">)</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Python27\lib\smtplib.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">614</span><span class="p">,</span> <span class="ow">in</span> <span class="n">login</span>
</span><span class='line'>    <span class="k">raise</span> <span class="n">SMTPAuthenticationError</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
</span><span class='line'><span class="n">smtplib</span><span class="o">.</span><span class="n">SMTPAuthenticationError</span><span class="p">:</span> <span class="p">(</span><span class="mi">534</span><span class="p">,</span> <span class="s">&#39;5.7.9 Application-specific password requ</span>
</span><span class='line'><span class="n">ired</span><span class="o">.</span> <span class="n">Learn</span> <span class="n">more</span> <span class="n">at</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.9</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">support</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">accounts</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">answer</span><span class="o">.</span><span class="n">py</span><span class="err">?</span><span class="n">answ</span>
</span><span class='line'><span class="n">er</span><span class="o">=</span><span class="mi">185833</span> <span class="n">w3sm2453216wjf</span><span class="o">.</span><span class="mi">3</span> <span class="o">-</span> <span class="n">gsmtp</span><span class="s">&#39;)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>




<p>Ohhh , Greate , because it&rsquo;s just showing me check out app password url and didn&rsquo;t send me any SMS. So it means my password is not wrong ! But to be sure I&rsquo;m going to test this with wrong password.</p>




<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Users\Ali\Desktop\gmail.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">22</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="n">a</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passw</span><span class="p">)</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Python27\lib\smtplib.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">614</span><span class="p">,</span> <span class="ow">in</span> <span class="n">login</span>
</span><span class='line'>    <span class="k">raise</span> <span class="n">SMTPAuthenticationError</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
</span><span class='line'><span class="n">smtplib</span><span class="o">.</span><span class="n">SMTPAuthenticationError</span><span class="p">:</span> <span class="p">(</span><span class="mi">535</span><span class="p">,</span> <span class="s">&#39;5.7.8 Username and Password not accepted</span>
</span><span class='line'><span class="o">.</span> <span class="n">Learn</span> <span class="n">more</span> <span class="n">at</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.8</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">support</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">answer</span><span class="o">.</span><span class="n">py</span><span class="err">?</span><span class="n">answer</span><span class="o">=</span><span class="mi">14257</span>
</span><span class='line'> <span class="n">bv6sm2577733wjb</span><span class="o">.</span><span class="mi">30</span> <span class="o">-</span> <span class="n">gsmtp</span><span class="s">&#39;)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>




<p>Now you can see different result. And let me test it with another Gmail which for a long time I didn&rsquo;t use.</p>




<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Users\Ali\Desktop\gmail.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">22</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="n">a</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passw</span><span class="p">)</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Python27\lib\smtplib.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">614</span><span class="p">,</span> <span class="ow">in</span> <span class="n">login</span>
</span><span class='line'>    <span class="k">raise</span> <span class="n">SMTPAuthenticationError</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
</span><span class='line'><span class="n">smtplib</span><span class="o">.</span><span class="n">SMTPAuthenticationError</span><span class="p">:</span> <span class="p">(</span><span class="mi">534</span><span class="p">,</span> <span class="s">&#39;5.7.14 &lt;https://accounts.google.com/Cont</span>
</span><span class='line'><span class="n">inueSignIn</span><span class="err">?</span><span class="n">sarp</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">scc</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">plt</span><span class="o">=</span><span class="n">AKgnsbu3u</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="n">pntQhm8PgwhQoRK6G4JaqbL5rcYK91sfB3</span>
</span><span class='line'><span class="n">SZJZlGQcF2y3WXgUa9vOyex8KMlF</span><span class="o">-</span><span class="n">labONEg</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="o">-</span><span class="n">yKrWWgN7PtH55A1TqK3e1gfitBHKmghSUW</span>
</span><span class='line'><span class="mi">4</span><span class="n">AgNsmZ6qASoci8_lqhS6MCLniXpgqW_OPs</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="n">dLg2YvDJ_QZpRQRV_i0l82hy22KcvUvDwscq</span>
</span><span class='line'><span class="n">ENWFs</span><span class="o">-</span><span class="n">dk6nrJrF_thrThuzS555KIFMnkEk</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="n">wueyxESEpgPC6RGqcwl9Pfo4kWTg</span><span class="o">&gt;</span> <span class="n">Please</span>
</span><span class='line'><span class="n">log</span> <span class="ow">in</span> <span class="n">via</span> <span class="n">your</span> <span class="n">web</span> <span class="n">browser</span> <span class="ow">and</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="n">then</span> <span class="k">try</span> <span class="n">again</span><span class="o">.</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.14</span> <span class="n">Learn</span> <span class="n">more</span> <span class="n">at</span>\<span class="n">n5</span>
</span><span class='line'><span class="o">.</span><span class="mf">7.14</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">support</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">answer</span><span class="o">.</span><span class="n">py</span><span class="err">?</span><span class="n">answer</span><span class="o">=</span><span class="mi">78754</span> <span class="n">bv6sm2501216wjb</span>
</span><span class='line'><span class="o">.</span><span class="mi">30</span> <span class="o">-</span> <span class="n">gsmtp</span><span class="s">&#39;)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>




<p>Now Google tells me use the browser to login. I don&rsquo;t care about error. But there&rsquo;s a point! What if we use a Gmail account which we didn&rsquo;t ever use on my PC till now. So I will use my friend&rsquo;s Gmail account and watch the result.</p>




<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Users\Ali\Desktop\gmail.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">22</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="n">a</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passw</span><span class="p">)</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;C:\Python27\lib\smtplib.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">614</span><span class="p">,</span> <span class="ow">in</span> <span class="n">login</span>
</span><span class='line'>    <span class="k">raise</span> <span class="n">SMTPAuthenticationError</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
</span><span class='line'><span class="n">smtplib</span><span class="o">.</span><span class="n">SMTPAuthenticationError</span><span class="p">:</span> <span class="p">(</span><span class="mi">534</span><span class="p">,</span> <span class="s">&#39;5.7.9 Application-specific password requ</span>
</span><span class='line'><span class="n">ired</span><span class="o">.</span> <span class="n">Learn</span> <span class="n">more</span> <span class="n">at</span>\<span class="n">n5</span><span class="o">.</span><span class="mf">7.9</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">support</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">accounts</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">answer</span><span class="o">.</span><span class="n">py</span><span class="err">?</span><span class="n">answ</span>
</span><span class='line'><span class="n">er</span><span class="o">=</span><span class="mi">185833</span> <span class="n">bo3sm2561309wjb</span><span class="o">.</span><span class="mi">44</span> <span class="o">-</span> <span class="n">gsmtp</span><span class="s">&#39;)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>




<p>It seems my friend&rsquo;s been given me true password but he activated Gmail SMS auth. So now we can see that Google didn&rsquo;t work hard on this way. When we have true password, we can login and steal information and if victim using Gmail SMS auth, however, we know what&rsquo;s the true password and only need a little social engineering to login and steal information.
All we need now it&rsquo;s a script to make it automatic check the Gmail account to login with this script and read error to see what happen. If you think I&rsquo;m going to make a automatic script for you, and put code here, I should tell you that, I am NOT.<br></p>




<h3>Reference</h3>




<p><a href="http://z3r0d4y.com/">ZCR</a> <span class="description">Zeroday Cyber Research</span>
<br><br><a href="mailto:Ali[dot]Razmjoo1994[at]Gmail[dot]Com">Ali Razmjoo</a>
<br><br>Last edit on: 2015/4/1 @13:42</p>

]]></content>
  </entry>
  
</feed>
